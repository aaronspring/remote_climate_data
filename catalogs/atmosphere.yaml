plugins:
  source:
    - module: intake_xarray

sources:
  HadCRUT4:
    description: Combined land [CRUTEM4] and marine [SST anomalies from HadSST3] temperature anomalies on a 5° by 5° grid (Morice et al., 2012)
    metadata:
      url: https://crudata.uea.ac.uk/cru/data/temperature/
      doi: http://doi.org/10.1029/2011JD017187
      plots:
        temperature_anomaly_over_time:
          title: HadCRUT4 temperature anomly wrt. 1960-1989
          kind: contourf
          x: longitude
          y: latitude
          z: temperature_anomaly
          ylim: [-90,90]
          xlim: [-180,180]
          groupby: time
          label: Temperature Anomaly [K]
          cmap: RdBu_r
          levels: 20 # clim: (-10, 10)  # once https://github.com/holoviz/hvplot/pull/492 is merged
        GMSTa:
          title: Global mean surface temperature anomaly wrt. 1960-1989
          kind: line
          x: time
          y: temperature_anomaly
    driver: netcdf
    args:
      urlpath: simplecache::https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT.4.6.0.0.median.nc
      chunks: {}
      xarray_kwargs:
        use_cftime: True

  HadCRUT5:
    description: Combined land [CRUTEM5] and marine [HadSST4] temperature anomalies on a 5° by 5° grid with greater geographical coverage via statistical infilling (Morice et al., 2020)
    metadata:
      url: https://www.metoffice.gov.uk/hadobs/hadcrut5/
      doi: http://doi.org/10.1029/2019JD032361
    driver: netcdf
    args:
      urlpath: simplecache::https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT.5.0.0.0.analysis.anomalies.ensemble_mean.nc
      chunks: {}

  HadCRUT5_Non-Infilled:
    description: Combined land [CRUTEM5] and marine [HadSST4] temperature anomalies on a 5° by 5° grid with geographical coverage limited to grid cells close to where we have measurements (Morice et al., 2020)
    metadata:
      url: https://www.metoffice.gov.uk/hadobs/hadcrut5/
      doi: http://doi.org/10.1029/2019JD032361
    driver: netcdf
    args:
      urlpath: simplecache::https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT.5.0.0.0.anomalies.ensemble_mean.nc
      chunks: {}

  CRU_TS:
    description: Climatic Research Unit (CRU) Time-Series (TS) of high-resolution gridded data of month-by-month variation in climate
    metadata:
      url: https://crudata.uea.ac.uk/cru/data/hrg
      comment: CEDA archive requires authorization, for setting up a certificate, please follow instructions from https://help.ceda.ac.uk/article/4712-reading-netcdf-with-python-opendap
    args:
      path: "{{CATALOG_DIR}}/atmosphere/cru_ts.yaml"
    driver: intake.catalog.local.YAMLFileCatalog

  trace_gases_at_stations:
    description: surface insitu measurements of Carbon Cycle Greenhouse Gases (CCGG), National Oceanic and Atmospheric Administration (NOAA), Earth System Research Laboratories (ESRL), Global Monitoring Laboratory (GML), defaults to Mauna Loa monthly CO2 measurements
    metadata:
      url: https://www.esrl.noaa.gov/gmd/ccgg/
      doi: add
      readme: ftp://aftp.cmdl.noaa.gov/data/trace_gases/{{variable}}/in-situ/surface/
    driver: netcdf
    parameters:
      freq:
        description: frequency of the measurements
        type: str
        default: Monthly
        allowed: [Hourly, Daily, Monthly]
      station:
        description: location of the measurements
        type: str
        default: mlo
        allowed: [mlo, brw, smo, spo] # Mauna LOa, BarRoW, American SaMOa, and South POle
      variable:
        description: variable
        type: str
        default: co2
        allowed: [co2, ch4]
    args:
      urlpath: ftp://aftp.cmdl.noaa.gov/data/trace_gases/{{variable}}/in-situ/surface/{{station}}/{{variable}}_{{station}}_surface-insitu_1_ccgg_{{freq}}Data.nc
      storage_options:
        simplecache:
          same_names: True
      xarray_kwargs:
        use_cftime: True

  fossil_fuel_emissions_gridded:
    description: daily 1x1 Gridded Fossil Fuel emissions from Open-source Data Inventory for Anthropogenic CO2 (ODIAC), Carbon Cycle Greenhouse Gases (CCGG), National Oceanic and Atmospheric Administration (NOAA), Earth System Research Laboratories (ESRL), Global Monitoring Laboratory (GML)
    metadata:
      url: https://www.odiac.org/index.html
      doi:
        - 10.17595/20170411.001 # data
        - 10.5194/acp-11-543-2011﻿ # journal
        - 10.5194/essd-10-87-2018 # journal
    driver: netcdf
    parameters:
      date:
        description: distribution of fossil fuel emissions
        type: datetime
        default: 2000.01.01
        min: 2000.01.01
      version:
        description: release, version of the ODIAC emissions
        type: str
        default: 2018
        allowed: [2015a, 2016, 2017, 2018]
      variable:
        description: variable
        type: str
        default: co2
        allowed: [co2, ch4]
    args:
      urlpath: ftp://aftp.cmdl.noaa.gov/data/ccgg/ODIAC/{{version}}/distrib/{{date.strftime("%Y")}}/{{date.strftime("%m")}}/fossil_fuel_1x1_{{date.strftime("%Y%m%d")}}.nc
      storage_options:
        simplecache:
          same_names: True
      xarray_kwargs:
        use_cftime: True

  NOAA_carbon_tracker:
    description: CarbonTracker is a CO2 measurement and modeling system developed by NOAA to keep track of sources (emissions to the atmosphere) and sinks (removal from the atmosphere) of carbon dioxide around the world.
    metadata:
      url: https://www.esrl.noaa.gov/gmd/ccgg/carbontracker
    driver: netcdf
    parameters:
      date:
        description: date of measurements
        type: datetime
        default: 2018.01.01
        min: 2000.01.01
      version:
        description: release, version of the ODIAC emissions
        type: str
        default: CT2019B
        allowed: [CT-NRT.v2015-1, CT-NRT.v2017-1, CT-NRT.v2018-1, CT-NRT.v2019-1, CT-NRT.v2020-1, CT2019B,CT2019,CT2017,CT2016, CT2015]
      variable:
        description: variable
        type: str
        default: co2
        allowed: [co2, ch4]
    args:
      urlpath: simplecache::ftp://aftp.cmdl.noaa.gov/products/carbontracker/co2/{{version}}/molefractions/co2_total_monthly/{{version}}.molefrac_glb3x2_{{date.strftime("%Y-%m")}}.nc
      storage_options:
        simplecache:
          same_names: True
      xarray_kwargs:
        use_cftime: True
